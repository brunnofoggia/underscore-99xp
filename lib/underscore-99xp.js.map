{"version":3,"file":"underscore-99xp.js","sources":["../src/underscore-99xp.js"],"sourcesContent":["// [Underscore-99xp](https://github.com/brunnofoggia/underscore-99xp) is an\n// extension based on experience of [Underscore](https://underscorejs.org/).\n// It provides configuration for rendering templates, new methods to do\n// complex work and string helpers not included on Underscore.\n\n\n// Baseline setup\n// --------------\nimport _ from 'underscore';\nimport _s from 'underscore.string';\n\n\n// Renderer - The common way\n// --------------\n\n// Template Rendering like Angular / Vue\n\n//     /* Samples */\n//     {{ my_variable }}\n//     {% if(true) { %} test {% } %}\n_.templateSettings = {\n    interpolate: /\\{\\{(.+?)\\}\\}/g,\n    evaluate: /\\{\\%(.+?)\\%\\}/g,\n    escape: /\\{-([\\s\\S]+?)-\\}/g\n};\n\n// Objects - Advanced helpers\n// --------------\n\n// Traverses the children of obj along path.\n// If a child is a function, it is invoked with given context and arguments.\n// Returns the value of the final child, or fallback if any child is undefined.\n_.result2 = function(obj, key, defaultValue, args, context) {\n    var v;\n    if (!obj || !_.isObject(obj) || (!args && !context) || typeof obj[key] !== 'function') {\n        v = _.result(obj, key, defaultValue);\n    } else {\n        var fn = obj[key];\n        if (context) {\n            fn = _.bind(fn, context);\n        }\n        if (args) {\n            fn = _.partial(_.partial, fn).apply(null, args);\n        }\n\n        v = fn() || defaultValue;\n    }\n\n    return v;\n};\n\n// Fill in a given object with default properties.\n// The object of this 2nd version is to work with not plain objects\n_.defaults2 = function(o, d) {\n    var k1 = [],\n        k2 = [];\n    var kd1 = [],\n        kd2 = [];\n\n    _.map(o, function(i, k) {\n        return _.isJSON(i) || _.isArray(i) ? k2.push(k) : k1.push(k);\n    });\n\n    _.map(d, function(i, k) {\n        return _.isJSON(i) || _.isArray(i) ? kd2.push(k) : kd1.push(k);\n    });\n\n    var o1 = _.partial(_.pick, o).apply(null, k1),\n        o2 = _.partial(_.pick, o).apply(null, k2);\n\n    var od1 = _.partial(_.pick, d).apply(null, kd1),\n        od2 = _.partial(_.pick, d).apply(null, kd2);\n\n    o1 = _.defaults(o1, od1);\n\n    var keys = [],\n        or2 = _.clone(o2);\n    if (_.size(od2)) {\n        _.map(od2, function(i, k) {\n            if (_.indexOf(keys, k) !== -1) {\n                return;\n            }\n            keys.push(k);\n            var r = _.defaults2(o2[k] || {}, od2[k]);\n\n            or2[k] = r;\n        });\n    }\n    if (_.size(o2)) {\n        _.map(o2, function(i, k) {\n            if (_.indexOf(keys, k) !== -1) {\n                return;\n            }\n            keys.push(k);\n            var r = _.defaults2(o2[k], od2[k] || {});\n\n            or2[k] = r;\n        });\n    }\n\n    o1 = _.extend(o1, or2);\n    return o1;\n};\n\n\n// Locate values into an object as the samples below\n\n//     /* Samples */\n//     var json = {name: '99xp', contacts: [ {email: 'team@99xp.org'} , {email: 'admin@99xp.org'} ]};\n//     \n//     _.deepValueSearch('name', json) = 99xp\n//     _.deepValueSearch('contacts[0][email]', json) = team@99xp.org\n//     _.deepValueSearch('contacts[][email]', json) = [team@99xp.org, admin@99xp.org]\n//     _.deepValueSearch('contacts', json) = [ {email: 'team@99xp.org'} , {email: 'admin@99xp.org'} ]\n//     _.deepValueSearch('contacts[]', json) = [ {email: 'team@99xp.org'} , {email: 'admin@99xp.org'} ]\n\n_.deepValueSearch = function(k, json, onlyObject = false) {\n    var p = typeof k === 'string' && k ? k.split(/\\[/) : k instanceof Array ? k : [];\n\n    if (!p.length) {\n        return json;\n    }\n\n    var pk = p.shift();\n\n    if (/^(\\w|\\_|\\-)+$/.test(pk)) {\n        return this.deepValueSearch(p, json[pk], onlyObject);\n    }\n\n    if (pk === ']') {\n        if (!p.length) {\n            return json;\n        }\n\n        if (json instanceof Array || _.isJSON(json)) {\n            var r = _.isJSON(json) || onlyObject ? {} : [];\n\n            for (var x in json) {\n                if (_.isJSON(r)) {\n                    r[x] = (this.deepValueSearch(_.clone(p), _.clone(json[x]), onlyObject));\n                } else {\n                    r.push(this.deepValueSearch(_.clone(p), _.clone(json[x]), onlyObject));\n                }\n            }\n\n            return r;\n        }\n    }\n\n    if (/(\\w|\\_|\\-)+\\]$/.test(pk)) {\n        pk = pk.replace(']', '');\n\n        if (!p.length) {\n            return json[pk];\n        }\n\n        return !json ? json : this.deepValueSearch(p, json[pk], onlyObject);\n    }\n};\n\nvar createFieldStack = function(k, o, r = {}) {\n    if (o && typeof o === 'object') {\n        for (var x in o) {\n            var str2 = k + '[' + x + ']';\n\n            if (typeof o[x] === 'object') {\n                createFieldStack(str2, o[x], r);\n            } else {\n                r[str2] = o[x];\n            }\n        }\n    } else {\n        r[k] = o;\n    }\n\n    return r;\n}\n\n// Convert complex json into form data\n\n//     /* Samples */\n//     var json = {name: '99xp', contacts: [ {email: 'team@99xp.org'} , {email: 'admin@99xp.org'} ]};\n//     \n//     _.jsonToHTMLForm(json) = {\n//         name: '99xp',\n//         'contacts[0][email]': 'team@99xp.org',\n//         'contacts[1][email]': 'admin@99xp.org'\n//      }\n\n_.jsonToHTMLForm = function(json) {\n    if (!_.isJSON(json)) {\n        return false;\n    }\n\n    var r = {};\n    if (_.size(json)) {\n        for (var x in json) {\n            r = createFieldStack(x, json[x], r);\n        }\n    }\n\n    return r;\n}\n\n// Locate keys into an object as the samples below\n\n//     /* Samples */\n//     var json = {name: '99xp', contacts: [ {email: 'team@99xp.org'} , {email: 'admin@99xp.org'} ]};\n//     \n//     _.deepValueSearch('name', json) = [name]\n//     _.deepValueSearch('contacts[][email]', json) = [contacts[0][email], contacts[1][email]]\n\n_.deepKeySearch = function(k, j) {\n    var o = _.jsonToHTMLForm(j),\n        r = [];\n    if (o) {\n        r = _.filter(_.keys(o), (x) => {\n            var rxp = new RegExp('^' + k.replace(/\\[\\]/, '[\\\\d+]').replace(/(\\[|\\])/g, '\\\\$1'), 'g');\n            return rxp.test(x);\n        });\n    }\n\n    return r;\n};\n\n// Checks if given object is not an array\n_.isOnlyObject = function(o) {\n    return _.isObject(o) && !_.isArray(o);\n};\n\n// Checks if given object is pure js object, not instance of any class\n_.isJSON = function(o) {\n    return _.isOnlyObject(o) && o.__proto__.__proto__ === null;\n}\n\n\n// String Helpers\n// --------------\n\n// Capture all occurrences in a string\n_.matchAll = function(s, regexp) {\n    var matches = [];\n    s.replace(regexp, function() {\n        var arr = ([]).slice.call(arguments, 0);\n        var extras = arr.splice(-2);\n        arr.index = extras[0];\n        arr.input = extras[1];\n        matches.push(arr);\n    });\n    return matches.length ? matches : null;\n};\n\n// Locate index of something into a string based on regexp\n_.regexIndexOf = function(s, regex, startpos) {\n    var indexOf = s.substring(startpos || 0).search(regex);\n    return (indexOf >= 0) ? (indexOf + (startpos || 0)) : indexOf;\n};\n\n// Locate last index of something into a string based on regexp\n_.regexLastIndexOf = function(s, regex, ignoreAfterPos) {\n    regex = (regex.global) ? regex :\n        new RegExp(regex.source, 'g' + (regex.ignoreCase ? 'i' : '') + (regex.multiLine ? 'm' : ''));\n\n    if (typeof ignoreAfterPos === 'undefined') {\n        ignoreAfterPos = s.length;\n    } else if (ignoreAfterPos < 0) {\n        ignoreAfterPos = 0;\n    }\n    var stringToWorkWith = s.substring(0, ignoreAfterPos + 1);\n    var lastIndexOf = -1;\n    var nextStop = 0;\n    var result;\n    while ((result = regex.exec(stringToWorkWith)) != null) {\n        lastIndexOf = result.index;\n        regex.lastIndex = ++nextStop;\n    }\n    return lastIndexOf;\n};\n\n// Transform string into date\n_.toDate = function(s) {\n    if (!/^\\d{4}\\-\\d{2}/.test(s)) {\n        return false;\n    }\n\n    var data = s.toString().split(_.regexIndexOf(s.toString(), /T/) > 0 ? 'T' : ' '),\n        dateStr = data[0].split('-'),\n        timeStr = data[1] ? data[1].split(':') : [0, 0, 0],\n        date;\n\n    date = new Date(dateStr[0], parseInt(dateStr[1] || 0, 10) - 1, parseInt(dateStr[2] || 1, 10), timeStr[0] || 0, timeStr[1] || 0, timeStr[2] || 0);\n    return date;\n};\n\n_.defaultPorts = {\n    'http': 80,\n    'https': 443,\n    'ftp': 21,\n};\n\n// get parts of a URL\n_.parseUrl = function(u) {\n    const regex = /^((http[s]?|ftp):\\/)?\\/?([^:\\/\\s]+)(:([^\\/]*))?(((\\/\\w+)*\\/)([\\w\\-\\.]+[^#?\\s]+)(\\?([^#]*))?(#(.*))?)$/gm;\n    var m = regex.exec(u);\n\n    if (m) {\n        return {\n            schema: m[2],\n            hostname: m[3],\n            port: m[5] || _.defaultPorts[m[2]],\n            path: m[6] || '',\n        };\n    }\n};\n\n// Add all string helpers from [underscore.string](https://github.com/esamattis/underscore.string) library\n_.mixin(_s.exports());\n\nexport default _;\n"],"names":["_","templateSettings","interpolate","evaluate","escape","result2","obj","key","defaultValue","args","context","v","isObject","result","fn","bind","partial","apply","defaults2","o","d","k1","k2","kd1","kd2","map","i","k","isJSON","isArray","push","o1","pick","o2","od1","od2","defaults","keys","or2","clone","size","indexOf","r","extend","deepValueSearch","json","onlyObject","p","split","Array","length","pk","shift","test","x","replace","createFieldStack","str2","jsonToHTMLForm","deepKeySearch","j","filter","rxp","RegExp","isOnlyObject","__proto__","matchAll","s","regexp","matches","arr","slice","call","arguments","extras","splice","index","input","regexIndexOf","regex","startpos","substring","search","regexLastIndexOf","ignoreAfterPos","global","source","ignoreCase","multiLine","stringToWorkWith","lastIndexOf","nextStop","exec","lastIndex","toDate","data","toString","dateStr","timeStr","date","Date","parseInt","defaultPorts","parseUrl","u","m","schema","hostname","port","path","mixin","_s","exports"],"mappings":"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"}